<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>WFP Dashboard Display</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    width: 100%;
    background: #000;
    overflow: hidden;
  }
  #frame {
    border: none;
    width: 100%;
    height: 100%;
  }
  #loading {
    position: absolute;
    inset: 0;
    display: grid;
    place-items: center;
    background: #000;
    color: #aaa;
    font-family: system-ui, Arial, sans-serif;
    opacity: 0;
    transition: opacity .3s ease;
    pointer-events: none;
  }
  #loading.show { opacity: .8; }
</style>
</head>
<body>
<iframe id="frame"
  sandbox="allow-same-origin allow-scripts allow-popups allow-forms"
  referrerpolicy="no-referrer"
  loading="eager"></iframe>

<div id="loading">Loading…</div>

<script>
  const urls = [
    "https://analytics.wfp.org/t/Public/views/TajikistanMarketUpdate_September15-21_2025/TajikistanMarketPriceUpdate?:embed=y&:device=desktop&:toolbar=no&:tabs=no&:showVizHome=no",
    "https://unwfp.maps.arcgis.com/apps/Cascade/index.html?appid=1e262af203064241b087c64a7a399d35",
    "https://analytics.wfp.org/t/Public/views/CCARB-ActivitiesTargetingandMonitoring/CCARB-ActivitiesTargetingandMonitoring?:embed=y&:device=desktop&:toolbar=no&:tabs=no&:showVizHome=no"
  ];

  const ROTATE_MS = 60000;
  const frame = document.getElementById('frame');
  const loading = document.getElementById('loading');
  let i = 0;

  function showLoader(v){ loading.classList.toggle('show', v); }

  function rotate() {
    showLoader(true);
    const url = urls[i];
    frame.onload = () => showLoader(false);
    frame.src = url;
    i = (i + 1) % urls.length;
  }

  rotate();
  setInterval(rotate, ROTATE_MS);

  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js').catch(()=>{});
  }
</script>
  <script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js', { scope: './' })
      .catch(()=>{ /* игнорируем, если запрещено политиками */ });
  }
</script>
</body>
</html>

